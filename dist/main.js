(()=>{var e={416:(e,t,n)=>{var a=n(495),i=n(490),r=n(892);t=a(!1);var o=i(r);t.push([e.id,".tu-config-container{padding:20px}.tu-config-container h3{display:inline-block;padding:5px 9px;color:#fff;border-radius:10px}.tu-config-container h3.energy{background-color:#f58181}.tu-config-container h3.water{background-color:#00a8ff}.tu-config-container .tu-icon{display:inline-block;width:15px;height:15px;background-repeat:no-repeat;background-position:center;background-size:contain;vertical-align:center;transform:translateY(3px);margin-right:5px;filter:invert(1)}.tu-config-container .tu-icon.energy{background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMC44NDgiIGhlaWdodD0iMzAuODQ5IiB2aWV3Qm94PSIwIDAgMzAuODQ4IDMwLjg0OSI+CiAgPHBhdGggaWQ9Ikljb25fbWV0cm8tcG93ZXIiIGRhdGEtbmFtZT0iSWNvbiBtZXRyby1wb3dlciIgZD0iTTE0LjEzOSwxLjkyOCwyLjU3MSwxNy4zNTJIMTQuMTM5TDYuNDI3LDMyLjc3NywzMy40MTksMTMuNUgxNy45OTVMMjkuNTYzLDEuOTI4WiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTIuNTcxIC0xLjkyOCkiLz4KPC9zdmc+Cg==)}.tu-config-container .tu-icon.water{background-image:url("+o+")}.tu-config-container .tu-energy,.tu-config-container .tu-water{display:flex;align-items:center;margin-bottom:40px}.tu-config-container .tu-energy .tu-unit,.tu-config-container .tu-water .tu-unit{margin:0px 10px;opacity:.7;font-size:1.2em}.tu-config-container .tu-energy label,.tu-config-container .tu-water label{width:100px;margin:0px}.tu-config-container .tu-energy input,.tu-config-container .tu-water input{width:100px}.tu-config-container .action{padding:20px;display:flex;justify-content:flex-end;align-items:center}",""]),e.exports=t},99:(e,t,n)=>{var a=n(495),i=n(490),r=n(892);t=a(!1);var o=i(r);t.push([e.id,".tenants{position:relative;height:85%;width:100%;padding:25px 15px 0 15px}.tenants .data-list{border:1px solid #e3e3e3}.tenants .data-list .data-table thead tr th{padding-left:15px;text-align:left;background:#e3e3e3}.tenants .data-list .data-list-item{height:50px}.tenants .data-list .data-list-item.active{background-color:#fafafa !important}.tenants .data-list-footer{position:unset}.tenants .data-table-item{margin-left:7.5px}.add-meter{display:flex}.add-meter .tenant-name{display:flex;margin-bottom:15px}.add-meter .tenant-name .label{width:60px;font-weight:700}.add-meter .row{display:flex;justify-content:space-between;width:100%}.add-meter .row .col{width:48%}.add-meter .row .col .uxp-form-label{font-weight:500}.add-meter .delete-meter{margin-top:45px}.add-meter .error{color:red;margin:15px 0;padding:5px}.add-meter .actions{margin:15px 0}.add-meter .actions .uxp-button{margin:0;float:right}.tu-meters{display:flex;font-size:10px;color:#fff;flex-wrap:wrap}.tu-meters.energy .tu-meter-id{background-color:#f58181}.tu-meters.energy .tu-logo{filter:invert(1);background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMC44NDgiIGhlaWdodD0iMzAuODQ5IiB2aWV3Qm94PSIwIDAgMzAuODQ4IDMwLjg0OSI+CiAgPHBhdGggaWQ9Ikljb25fbWV0cm8tcG93ZXIiIGRhdGEtbmFtZT0iSWNvbiBtZXRyby1wb3dlciIgZD0iTTE0LjEzOSwxLjkyOCwyLjU3MSwxNy4zNTJIMTQuMTM5TDYuNDI3LDMyLjc3NywzMy40MTksMTMuNUgxNy45OTVMMjkuNTYzLDEuOTI4WiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTIuNTcxIC0xLjkyOCkiLz4KPC9zdmc+Cg==)}.tu-meters.water .tu-meter-id{background-color:#00a8ff}.tu-meters.water .tu-logo{background-image:url("+o+")}.tu-meters .tu-meter-id{padding:5px 8px;display:flex;border-radius:8px;align-items:center;color:#fff;margin:2px}.tu-meters .tu-meter-id .tu-logo{background-size:contain;background-position:center;background-repeat:no-repeat;width:20px;height:20px}.tu-meters .tu-meter-id .tu-txt{margin-left:5px}",""]),e.exports=t},495:e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=function(e,t){var n,a,i,r=e[1]||"",o=e[3];if(!o)return r;if(t&&"function"==typeof btoa){var l=(n=o,a=btoa(unescape(encodeURIComponent(JSON.stringify(n)))),i="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(a),"/*# ".concat(i," */")),u=o.sources.map((function(e){return"/*# sourceURL=".concat(o.sourceRoot||"").concat(e," */")}));return[r].concat(u).concat([l]).join("\n")}return[r].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(n,"}"):n})).join("")},t.i=function(e,n,a){"string"==typeof e&&(e=[[null,e,""]]);var i={};if(a)for(var r=0;r<this.length;r++){var o=this[r][0];null!=o&&(i[o]=!0)}for(var l=0;l<e.length;l++){var u=[].concat(e[l]);a&&i[u[0]]||(n&&(u[2]?u[2]="".concat(n," and ").concat(u[2]):u[2]=n),t.push(u))}},t}},490:e=>{"use strict";e.exports=function(e,t){return t||(t={}),"string"!=typeof(e=e&&e.__esModule?e.default:e)?e:(/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),t.hash&&(e+=t.hash),/["'() \t\n]/.test(e)||t.needQuotes?'"'.concat(e.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):e)}},264:(e,t,n)=>{"use strict";var a,i=function(){var e={};return function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}e[t]=n}return e[t]}}(),r=[];function o(e){for(var t=-1,n=0;n<r.length;n++)if(r[n].identifier===e){t=n;break}return t}function l(e,t){for(var n={},a=[],i=0;i<e.length;i++){var l=e[i],u=t.base?l[0]+t.base:l[0],s=n[u]||0,c="".concat(u," ").concat(s);n[u]=s+1;var d=o(c),f={css:l[1],media:l[2],sourceMap:l[3]};-1!==d?(r[d].references++,r[d].updater(f)):r.push({identifier:c,updater:p(f,t),references:1}),a.push(c)}return a}function u(e){var t=document.createElement("style"),a=e.attributes||{};if(void 0===a.nonce){var r=n.nc;r&&(a.nonce=r)}if(Object.keys(a).forEach((function(e){t.setAttribute(e,a[e])})),"function"==typeof e.insert)e.insert(t);else{var o=i(e.insert||"head");if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(t)}return t}var s,c=(s=[],function(e,t){return s[e]=t,s.filter(Boolean).join("\n")});function d(e,t,n,a){var i=n?"":a.media?"@media ".concat(a.media," {").concat(a.css,"}"):a.css;if(e.styleSheet)e.styleSheet.cssText=c(t,i);else{var r=document.createTextNode(i),o=e.childNodes;o[t]&&e.removeChild(o[t]),o.length?e.insertBefore(r,o[t]):e.appendChild(r)}}function f(e,t,n){var a=n.css,i=n.media,r=n.sourceMap;if(i?e.setAttribute("media",i):e.removeAttribute("media"),r&&"undefined"!=typeof btoa&&(a+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(r))))," */")),e.styleSheet)e.styleSheet.cssText=a;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(a))}}var g=null,m=0;function p(e,t){var n,a,i;if(t.singleton){var r=m++;n=g||(g=u(t)),a=d.bind(null,n,r,!1),i=d.bind(null,n,r,!0)}else n=u(t),a=f.bind(null,n,t),i=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)};return a(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;a(e=t)}else i()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=(void 0===a&&(a=Boolean(window&&document&&document.all&&!window.atob)),a));var n=l(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var a=0;a<n.length;a++){var i=o(n[a]);r[i].references--}for(var u=l(e,t),s=0;s<n.length;s++){var c=o(n[s]);0===r[c].references&&(r[c].updater(),r.splice(c,1))}n=u}}}},485:(e,t,n)=>{var a=n(264),i=n(416);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.id,i,""]]);a(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},273:(e,t,n)=>{var a=n(264),i=n(99);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.id,i,""]]);a(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},892:e=>{e.exports="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='20.718' height='22.426' viewBox='0 0 20.718 22.426'%3E%3Cdefs%3E%3Cstyle%3E.a%7Bfill:%23424242;%7D%3C/style%3E%3C/defs%3E%3Cpath class='a' d='M13.973,11.739c-.573,4.614-3.5,5.435-3.5,8.643a3.632,3.632,0,0,0,7.263,0c0-3.208-2.927-4.029-3.5-8.643a.136.136,0,0,0-.264,0ZM7.246,1.647c-.573,4.614-3.5,5.434-3.5,8.643a3.631,3.631,0,0,0,7.262,0c0-3.208-2.927-4.029-3.5-8.643a.135.135,0,0,0-.262,0Zm13.456,0c-.573,4.614-3.5,5.435-3.5,8.643a3.631,3.631,0,0,0,7.262,0c0-3.208-2.927-4.029-3.5-8.643a.135.135,0,0,0-.262,0Z' transform='translate(-3.746 -1.544)'/%3E%3C/svg%3E"},896:function(e,t,n){"use strict";var a=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(i,r){function o(e){try{u(a.next(e))}catch(e){r(e)}}function l(e){try{u(a.throw(e))}catch(e){r(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,l)}u((a=a.apply(e,t||[])).next())}))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PriceConfig=void 0;const r=i(n(363)),o=n(432);n(485);const l="TenantUMS";function u(e){return(Number(e)||0).toFixed(2)}t.PriceConfig=e=>{const[t,n]=r.default.useState(""),[i,s]=r.default.useState(""),[c,d]=r.default.useState(!0),f=(0,o.useToast)();return r.default.useEffect((()=>{e.uxpContext.executeAction(l,"GetGlobalSettings",{},{json:!0}).then((e=>{let t=(null==e?void 0:e.settings)||{};n(u(t.energyRate)),s(u(t.waterRate)),d(!1)})).catch((e=>{f.error(e||"An error occurred while loading settings")}))}),[]),r.default.createElement(o.WidgetWrapper,{className:"tu-price-config"},c&&r.default.createElement(o.DefaultLoader,null),!c&&r.default.createElement(r.default.Fragment,null,r.default.createElement(o.TitleBar,{title:"Global Tenant Utility Metering Configuration"}),r.default.createElement("div",{className:"tu-config-container"},r.default.createElement("h3",{className:"energy"},r.default.createElement("span",{className:"tu-icon energy"}),"Energy Rates"),r.default.createElement("div",{className:"tu-energy"},r.default.createElement("label",null,"Per-Unit Rate"),r.default.createElement("div",{className:"tu-unit"},"$"),r.default.createElement(o.Input,{value:t,onChange:n}),r.default.createElement("div",{className:"tu-unit"},"/kwh")),r.default.createElement("h3",{className:"water"},r.default.createElement("span",{className:"tu-icon water"}),"Water Rates"),r.default.createElement("div",{className:"tu-water"},r.default.createElement("label",null,"Per-Unit Rate"),r.default.createElement("div",{className:"tu-unit"},"$"),r.default.createElement(o.Input,{value:i,onChange:s}),r.default.createElement("div",{className:"tu-unit"},"/ltr")),r.default.createElement("div",{className:"action"},r.default.createElement("div",{className:"save"},r.default.createElement(o.AsyncButton,{title:"Save",onClick:()=>a(void 0,void 0,void 0,(function*(){try{yield e.uxpContext.executeAction(l,"SaveGlobalSettings",{settings:{energyRate:Number(t),waterRate:Number(i)}}),f.success("Configuration saved!")}catch(e){f.error(e||"An error ocurred while saving")}}))}))))))}},632:function(e,t,n){"use strict";var a=this&&this.__createBinding||(Object.create?function(e,t,n,a){void 0===a&&(a=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,a,i)}:function(e,t,n,a){void 0===a&&(a=n),e[a]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return i(t,e),t},o=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(i,r){function o(e){try{u(a.next(e))}catch(e){r(e)}}function l(e){try{u(a.throw(e))}catch(e){r(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,l)}u((a=a.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const l=r(n(363)),u=n(432);t.default=e=>{const t=(0,u.useToast)(),[n,a]=(0,l.useState)([]),[i,r]=(0,l.useState)([]),[s,c]=(0,l.useState)(""),[d,f]=(0,l.useState)([]),[g,m]=(0,l.useState)(null),[p,h]=(0,l.useState)(null),[v,b]=(0,l.useState)(!1),[y,x]=(0,l.useState)(null),[w,E]=(0,l.useState)([]),[M,N]=(0,l.useState)(null),[C,j]=l.default.useState("energy");function T(){return o(this,void 0,void 0,(function*(){const t=yield e.uxpContext.executeAction("TenantUMS","GetAllRegisteredMeters",{}),n=JSON.parse(t);f(n)}))}return(0,l.useEffect)((()=>{!function(){o(this,void 0,void 0,(function*(){const t=yield e.uxpContext.executeAction("TenantUMS","GetAllMeters",{type:C}),n=JSON.parse(t);r(n)}))}()}),[C]),(0,l.useEffect)((()=>{T(),function(){o(this,void 0,void 0,(function*(){const t=yield e.uxpContext.executeAction("TenantUMS","GetAllTenants",{}),n=JSON.parse(t);a(null==n?void 0:n.tenants)}))}()}),[]),l.default.createElement(u.WidgetWrapper,null,l.default.createElement(u.TitleBar,{title:"Tenant Meter Configuration"}),l.default.createElement(u.DataTable,{className:"tenants",data:n,pageSize:5,activeClass:"active",columns:[{title:"Name",width:"40%",renderColumn:e=>l.default.createElement("div",{className:"data-table-item"},null==e?void 0:e.tenantName)},{title:"Meters",width:"40%",renderColumn:e=>l.default.createElement("div",{className:"data-table-item"},function(e){const t=d.filter((t=>t.tenant===e));let n=t.filter((e=>"water"==e.type)),a=t.filter((e=>"energy"==e.type));return l.default.createElement(l.default.Fragment,null,l.default.createElement("div",{className:"tu-meters water"},n.map((e=>l.default.createElement("div",{className:"tu-meter-id"},l.default.createElement("div",{className:"tu-logo"}),l.default.createElement("div",{className:"tu-txt"},e.meter))))),l.default.createElement("div",{className:"tu-meters energy"},a.map((e=>l.default.createElement("div",{className:"tu-meter-id"},l.default.createElement("div",{className:"tu-logo"}),l.default.createElement("div",{className:"tu-txt"},e.meter))))))}(null==e?void 0:e.tenantID))},{title:"",width:"20%",renderColumn:e=>l.default.createElement(u.Button,{title:"Edit",onClick:()=>function(e){b(!0),m(e);const t=d.filter((t=>t.tenant===e.tenantID));E(t)}(e)})}]}),l.default.createElement(u.Modal,{className:"add-meter",title:"Register Meter",show:v,onClose:()=>b(!1),headerContent:l.default.createElement(l.default.Fragment,null,l.default.createElement(u.ToggleFilter,{options:[{value:"energy",label:"Energy"},{value:"water",label:"Water"}],value:C,onChange:j}))},l.default.createElement("div",{className:"register-meter"},l.default.createElement("div",{className:"row"},l.default.createElement("div",{className:"col"},l.default.createElement(u.Label,null,"Select Meter"),l.default.createElement(u.Select,{options:i,selected:p,valueField:"id",labelField:"name",onChange:e=>{x(null),h(e)}})),l.default.createElement("div",{className:"col"},l.default.createElement(u.Label,null,"Budget"),l.default.createElement(u.Input,{type:"number",value:s,onChange:e=>{x(null),c(e)}}))),y&&l.default.createElement("div",{className:"error"},y),l.default.createElement("div",{className:"actions"},l.default.createElement(u.AsyncButton,{title:"Add Meter",onClick:()=>function(){return o(this,void 0,void 0,(function*(){if(!p)return void x("Please select a meter from the list");const n={budget:s,meterId:p,tenantId:null==g?void 0:g.tenantID,type:C};"{}"===(yield e.uxpContext.executeAction("TenantUMS","AddMeter",n))?t.error("This meter is already in use, please check for another meter"):t.info("Meter added successfully!!!"),c(""),b(!1),h(null),T()}))}()}))),l.default.createElement("div",{className:"delete-meter"},l.default.createElement("div",{className:"col"},l.default.createElement(u.Label,null,"Select Meter"),l.default.createElement(u.Select,{options:w,selected:M,valueField:"meter",labelField:"meter",onChange:e=>{x(null),N(e)}})),l.default.createElement("div",{className:"actions"},l.default.createElement(u.AsyncButton,{title:"Delete Meter",onClick:()=>function(){return o(this,void 0,void 0,(function*(){const t={meterId:M,tenantId:null==g?void 0:g.tenantID,type:C};yield e.uxpContext.executeAction("TenantUMS","DeleteMeterForTenant",t),b(!1),T()}))}()})))))}},629:function(e,t,n){"use strict";var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=n(484);n(273);const r=a(n(632)),o=n(896);(0,i.registerWidget)({id:"ums_tenant",widget:r.default,configs:{layout:{}}}),(0,i.registerWidget)({id:"price-config",widget:o.PriceConfig,configs:{layout:{}}})},484:function(e,t,n){"use strict";var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.registerUI=t.registerMenuItem=t.registerLink=t.registerWidget=void 0;const i=a(n(354));t.registerWidget=function(e){var t;let n=(i.default.id+"/widget/"+e.id).toLowerCase();if(!window.registerWidget)return void console.error("This code is not being run within the context of UXP");let a=null===(t=i.default.widgets)||void 0===t?void 0:t.find((t=>t.id==e.id));if(!a)throw console.log("Please update the bundle.json"),"Error: The widget you are trying to register is not in the bundle.json. Please update the bundle.json before continue";let r=Object.assign(Object.assign(Object.assign({},e),a),{id:n});window.registerWidget(r)},t.registerLink=function(e){var t;let n=(i.default.id+"/sidebarlink/"+e.id).toLowerCase();if(!window.registerLink)return void console.error("This is not is not being run within the UXP context");console.log("registering link....",n);let a=null===(t=i.default.sidebarLinks)||void 0===t?void 0:t.find((t=>t.id==e.id));if(!a)throw console.log("Please update the bundle.json"),"Error: The sidebar link you are trying to register is not in the bundle.json. Please update the bundle.json before continue";let r=Object.assign(Object.assign(Object.assign({},e),a),{id:n});window.registerLink(r)},t.registerMenuItem=function(e){let t=(i.default.id+"/menuitem/"+e.id).toLowerCase();if(!window.registerMenuItem)return void console.error("This is not is not being run within the UXP context");console.log("registering menu item....",t);let n=i.default.menuItems.find((t=>t.id==e.id));if(!n)throw console.log("Please update the bundle.json"),"Error: The menu item you are trying to register is not in the bundle.json. Please update the bundle.json before continue";let a=Object.assign(Object.assign(Object.assign({},e),n),{id:t});window.registerMenuItem(a)},t.registerUI=function(e){let t=(i.default.id+"/ui/"+e.id).toLowerCase();if(!window.registerUI)return void console.error("This is not is not being run within the UXP context");console.log("registering link....",t);let n=i.default.uis.find((t=>t.id==e.id));if(!n)throw console.log("Please update the bundle.json"),"Error: The ui you are trying to register is not in the bundle.json. Please update the bundle.json before continue";let a=Object.assign(Object.assign(Object.assign({},e),n),{id:t});window.registerUI(a)}},363:e=>{"use strict";e.exports=React},432:e=>{"use strict";e.exports=UXPComponents},354:e=>{"use strict";e.exports=JSON.parse('{"id":"dece8055-b3de-42ec-b596-8ffa8fd0a794","author":"eutech","widgets":[{"id":"ums_tenant","name":"UMS Tenant","description":"UMS Tenant","icon":"","tags":[]},{"id":"price-config","name":"Tenant Utility Metering Configuration","description":"This widget is for configuring various rates and parameters for tenant utility metering and billing","icon":"","tags":[]}],"sidebarLinks":[],"uis":[],"menuItems":[]}')}},t={};function n(a){var i=t[a];if(void 0!==i)return i.exports;var r=t[a]={id:a,exports:{}};return e[a].call(r.exports,r,r.exports,n),r.exports}n.nc=void 0,n(629)})();
//# sourceMappingURL=main.js.map